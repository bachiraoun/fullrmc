<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>fullrmc package &mdash; fullrmc 3.0.0, the Reverse Monte Carlo (RMC) package</title>
    
    <link rel="stylesheet" href="_static/fullrmc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            <link rel="author" title="About these documents" href="about.html" />
            <link rel="top" title="fullrmc 3.0.0, the Reverse Monte Carlo (RMC) package" href="#" />
            <link rel="next" title="fullrmc.Core package" href="fullrmc.Core.html" />
    
    <!-- -------------------------------------------------------------------------- -->
    <!-- ----- ADD a Mathjax CONFIGURATION SCRIPT TO EACH HTML FILE PRODUCED ------ -->
    <!-- ----- BY SPHINX. THEREFORE \AA WILL BE RENDERED AS Angstrom SYMBOL. ------ -->
        <script type="text/x-mathjax-config"> MathJax.Hub.Config({
        "TeX": {Macros: {AA : "{\\unicode{x212B}}"}}, "HTML-CSS": {scale: 100}});
        </script>
    
    </head>
  
    <body>
        <!-- ------------------------------------- -->
        <!-- ----- CREATE A STATIC MENU BAR ------ -->
        <div class="menu"> 
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="versions.html">Versions</a></li>
                <li><a href="QAForum.html">Q&A Forum</a></li>
                <li><a href="fullrmc.Selectors.html">Selectors</a></li>
                <li><a href="fullrmc.Generators.html">Generators</a></li>
                <li><a href="fullrmc.Constraints.html">Constraints</a></li>
                <li><a href="examples.html">Examples</a></li>
                <li><a href="about.html">About</a></li>
                <!-- pypi and github forkme link images table -->
                <li> 
                    <table style="position: absolute; right:0; top:0;">
                        <!-- pypi image -->
                        <td><a href="https://pypi.python.org/pypi/fullrmc">
                            <img height="40";
                                 src="_static/pypi.png"
                                 alt="Download me on PyPI"/>   
                        </a></td> 
                        <!-- github image -->
                        <td><a href="https://github.com/bachiraoun/fullrmc.git">
                            <img height="40";
                                 src="_static/forkme.png"
                                 alt="Fork me on GitHub" />   
                        </a></td>
                    </table>
                </li>
                <!-- ------------------------------------- -->
            </ul>
            <div class="clear"></div>
        </div>
        <!----------  STATIC MENU BAR STYLE --------->    
        <style>
        .menu { height: 42px; background-color:black; margin:0px;  
                z-index: 9999; position:Fixed;
                left: 0; top: 0; width: 100%; }
            .menu ul { list-style: none; }
            .menu ul li{float: left; padding-left: 6px;  padding-right: 6px;  border-right: 1px solid #ACACAC;}
            .menu ul li a { font-size:16px; color:white;}
            .menu ul li a:hover{ text-decoration: underline;}
        </style>
        <!-- ------ ENF OF MENU BAR CREATION ----- -->
        <!-- ------------------------------------- -->
        
        <div style="margin-top:40px"> </div>  
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a>
             |
        
        </li>
        <li class="right" >
          <a href="fullrmc.Core.html" title="fullrmc.Core package"
             accesskey="N">next</a>
             |
        
        </li>
        <li><a href="#">fullrmc 3.0.0, the Reverse Monte Carlo (RMC) package</a> &raquo;</li> 
      </ul>
    </div>
         
         
        
        
        <div class="document">
        <div class="documentwrapper">
            <div class="bodywrapper">
        <div class="body">
        
  <div class="section" id="module-fullrmc">
<span id="fullrmc-package"></span><h1>fullrmc package<a class="headerlink" href="#module-fullrmc" title="Permalink to this headline">¶</a></h1>
<img src="_images/inheritance-3c6daec5223c7f23c1745405afe6823312bee130.png" alt="Inheritance diagram of fullrmc.Engine" usemap="#inheritance3c5c761ed2" class="inheritance"/>
<map id="inheritance3c5c761ed2" name="inheritance3c5c761ed2">
<area shape="rect" id="node1" title="fulrmc&#39;s Reverse Monte Carlo (RMC) engine, used to launched a RMC simulation. " alt="" coords="5,5,156,29"/>
</map>
<img src="_images/inheritance-ceb47057e134f59453caa234243f0e66a005e116.png" alt="Inheritance diagram of fullrmc.Core.Group" usemap="#inheritance53638427b4" class="inheritance"/>
<map id="inheritance53638427b4" name="inheritance53638427b4">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Group.EmptyGroup" target="_top" title="Empty group is a special group that takes no atoms indexes. It&#39;s mainly used" alt="" coords="228,5,441,29"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Group.Group" target="_top" title="A Group is a set of atoms indexes container. " alt="" coords="5,5,180,29"/>
</map>
<img src="_images/inheritance-3b3bbd6abdab0984b62eb145c8e74407db36fe0e.png" alt="Inheritance diagram of fullrmc.Selectors.RandomSelectors, fullrmc.Selectors.OrderedSelectors, fullrmc.Generators.Translations, fullrmc.Generators.Rotations, fullrmc.Generators.Swaps, fullrmc.Generators.Agitations, fullrmc.Generators.Removes, fullrmc.Constraints.AtomicCoordinationConstraints, fullrmc.Constraints.DistanceConstraints, fullrmc.Constraints.BondConstraints, fullrmc.Constraints.AngleConstraints, fullrmc.Constraints.DihedralAngleConstraints, fullrmc.Constraints.ImproperAngleConstraints, fullrmc.Constraints.PairDistributionConstraints, fullrmc.Constraints.PairCorrelationConstraints, fullrmc.Constraints.StructureFactorConstraints" usemap="#inheritanced3b55c4c54" class="inheritance"/>
<map id="inheritanced3b55c4c54" name="inheritanced3b55c4c54">
<area shape="rect" id="node1" href="fullrmc.Generators.html#fullrmc.Generators.Agitations.AngleAgitationGenerator" target="_top" title="Generates random agitation moves upon an angle defined between two vectors left&#45;central and right&#45;central " alt="" coords="176,389,344,413"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.MoveGenerator.MoveGenerator" target="_top" title="It is the parent class for all moves generators." alt="" coords="5,557,119,581"/>
<area shape="rect" id="node7" href="fullrmc.Core.html#fullrmc.Core.MoveGenerator.RemoveGenerator" target="_top" title="This is a very particular move generator that will not generate moves on atoms but " alt="" coords="194,437,325,461"/>
<area shape="rect" id="node16" href="fullrmc.Generators.html#fullrmc.Generators.Agitations.DistanceAgitationGenerator" target="_top" title="Generates random agitation moves upon a distance separating two atoms by translating" alt="" coords="167,485,352,509"/>
<area shape="rect" id="node20" href="fullrmc.Generators.html#fullrmc.Generators.Rotations.OrientationGenerator" target="_top" title="Generates rotational moves upon groups of atoms to align and orient along an axis." alt="" coords="187,533,333,557"/>
<area shape="rect" id="node23" href="fullrmc.Core.html#fullrmc.Core.MoveGenerator.PathGenerator" target="_top" title="PathGenerator is a MoveGenerator sub&#45;class where moves definitions are pre&#45;stored in a path " alt="" coords="205,581,314,605"/>
<area shape="rect" id="node28" href="fullrmc.Generators.html#fullrmc.Generators.Rotations.RotationGenerator" target="_top" title="Generates random rotational moves upon groups of atoms." alt="" coords="194,629,325,653"/>
<area shape="rect" id="node34" href="fullrmc.Core.html#fullrmc.Core.MoveGenerator.SwapGenerator" target="_top" title="It is a particular move generator that instead of generating a " alt="" coords="203,701,317,725"/>
<area shape="rect" id="node37" href="fullrmc.Generators.html#fullrmc.Generators.Translations.TranslationGenerator" target="_top" title="Generates random translations moves upon groups of atoms." alt="" coords="186,821,333,845"/>
<area shape="rect" id="node3" href="fullrmc.Constraints.html#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint" target="_top" title="It&#39;s a rigid constraint that controls the coordination number between atoms. " alt="" coords="732,101,978,125"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" target="_top" title="A rigid constraint is a constraint that doesn&#39;t count into the total standardError of the Engine." alt="" coords="477,245,590,269"/>
<area shape="rect" id="node8" href="fullrmc.Constraints.html#fullrmc.Constraints.BondConstraints.BondConstraint" target="_top" title="Controls the bond length defined between 2 defined atoms." alt="" coords="799,149,912,173"/>
<area shape="rect" id="node9" href="fullrmc.Constraints.html#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint" target="_top" title="Controls the angle defined between 3 defined atoms, a first atom called central" alt="" coords="778,197,932,221"/>
<area shape="rect" id="node14" href="fullrmc.Constraints.html#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint" target="_top" title="Dihedral angle is defined between two intersecting planes formed with four defined " alt="" coords="772,245,938,269"/>
<area shape="rect" id="node18" href="fullrmc.Constraints.html#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint" target="_top" title="Controls the improper angle formed with 4 defined atoms. It&#39;s mainly used to " alt="" coords="771,293,940,317"/>
<area shape="rect" id="node19" href="fullrmc.Constraints.html#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint" target="_top" title=".. py:class::InterMolecularDistanceConstraint" alt="" coords="746,341,965,365"/>
<area shape="rect" id="node5" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" target="_top" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="468,197,599,221"/>
<area shape="rect" id="node6" href="fullrmc.Generators.html#fullrmc.Generators.Removes.AtomsRemoveGenerator" target="_top" title="This generator allows removing single atoms at a time from the system. Atoms are" alt="" coords="449,437,618,461"/>
<area shape="rect" id="node10" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" target="_top" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="219,245,301,269"/>
<area shape="rect" id="node17" href="fullrmc.Core.html#fullrmc.Core.Constraint.ExperimentalConstraint" target="_top" title="An ExperimentalConstraint is any constraint related to experimental data." alt="" coords="454,389,613,413"/>
<area shape="rect" id="node11" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" target="_top" title="All listeners base class." alt="" coords="13,245,112,269"/>
<area shape="rect" id="node12" href="fullrmc.Selectors.html#fullrmc.Selectors.OrderedSelectors.DefinedOrderSelector" target="_top" title="DefinedOrderSelector is a group selector with a defined order of selection." alt="" coords="185,5,335,29"/>
<area shape="rect" id="node15" href="fullrmc.Selectors.html#fullrmc.Selectors.OrderedSelectors.DirectionalOrderSelector" target="_top" title="DirectionalOrderSelector is a group selector with a defined order of selection." alt="" coords="450,5,617,29"/>
<area shape="rect" id="node13" href="fullrmc.Core.html#fullrmc.Core.GroupSelector.GroupSelector" target="_top" title="GroupSelector is the parent class that selects groups to perform moves upon engine runtime." alt="" coords="9,29,116,53"/>
<area shape="rect" id="node24" href="fullrmc.Selectors.html#fullrmc.Selectors.RandomSelectors.RandomSelector" target="_top" title="RandomSelector generates indexes randomly for engine group selection." alt="" coords="200,53,320,77"/>
<area shape="rect" id="node22" href="fullrmc.Constraints.html#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint" target="_top" title="It controls the total reduced pair distribution function (pdf) of the system noted as G(r). " alt="" coords="769,389,942,413"/>
<area shape="rect" id="node26" href="fullrmc.Constraints.html#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint" target="_top" title="It controls the Structure Factor noted as S(Q) and also called" alt="" coords="768,437,942,461"/>
<area shape="rect" id="node21" href="fullrmc.Constraints.html#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint" target="_top" title="It controls the total pair correlation function (pcf) of the system noted as g(r)." alt="" coords="1072,389,1243,413"/>
<area shape="rect" id="node30" href="fullrmc.Generators.html#fullrmc.Generators.Rotations.RotationAboutSymmetryAxisPath" target="_top" title="Generates rotational moves upon groups of atoms about one of their symmetry axis." alt="" coords="424,509,643,533"/>
<area shape="rect" id="node39" href="fullrmc.Generators.html#fullrmc.Generators.Translations.TranslationAlongSymmetryAxisPath" target="_top" title="Generates translation moves upon groups of atoms along one of their symmetry axis." alt="" coords="417,557,650,581"/>
<area shape="rect" id="node32" href="fullrmc.Selectors.html#fullrmc.Selectors.RandomSelectors.WeightedRandomSelector" target="_top" title="WeightedRandomSelector generates indexes randomly following groups weighting scheme." alt="" coords="445,53,622,77"/>
<area shape="rect" id="node25" href="fullrmc.Constraints.html#fullrmc.Constraints.StructureFactorConstraints.ReducedStructureFactorConstraint" target="_top" title="The Reduced Structure Factor that we will also note S(Q) " alt="" coords="1044,437,1272,461"/>
<area shape="rect" id="node27" href="fullrmc.Generators.html#fullrmc.Generators.Rotations.RotationAboutAxisGenerator" target="_top" title="Generates random rotational moves upon groups of atoms about a pre&#45;defined axis." alt="" coords="438,605,629,629"/>
<area shape="rect" id="node29" href="fullrmc.Generators.html#fullrmc.Generators.Rotations.RotationAboutSymmetryAxisGenerator" target="_top" title="Generates random rotational moves upon groups of atoms about one of their symmetry axis." alt="" coords="408,653,659,677"/>
<area shape="rect" id="node31" href="fullrmc.Selectors.html#fullrmc.Selectors.RandomSelectors.SmartRandomSelector" target="_top" title="SmartRandomSelector is a random group selector fed with machine learning algorithm." alt="" coords="777,53,933,77"/>
<area shape="rect" id="node33" href="fullrmc.Generators.html#fullrmc.Generators.Swaps.SwapCentersGenerator" target="_top" title="Computes geometric center of the selected group, and swaps its atoms" alt="" coords="453,701,614,725"/>
<area shape="rect" id="node35" href="fullrmc.Generators.html#fullrmc.Generators.Swaps.SwapPositionsGenerator" target="_top" title="Generates positional swapping between atoms of the selected group and other atoms" alt="" coords="449,749,618,773"/>
<area shape="rect" id="node36" href="fullrmc.Generators.html#fullrmc.Generators.Translations.TranslationAlongAxisGenerator" target="_top" title="Generates random translation moves upon groups of atoms along a pre&#45;defined axis." alt="" coords="430,797,637,821"/>
<area shape="rect" id="node40" href="fullrmc.Generators.html#fullrmc.Generators.Translations.TranslationTowardsAxisGenerator" target="_top" title="Generates random translation moves upon groups of atoms towards a pre&#45;defined axis" alt="" coords="745,797,966,821"/>
<area shape="rect" id="node38" href="fullrmc.Generators.html#fullrmc.Generators.Translations.TranslationAlongSymmetryAxisGenerator" target="_top" title="Generates random translation moves upon groups of atoms along one of their symmetry axis." alt="" coords="400,845,667,869"/>
<area shape="rect" id="node41" href="fullrmc.Generators.html#fullrmc.Generators.Translations.TranslationTowardsCenterGenerator" target="_top" title="Generates random translation moves of every atom of the group along its direction vector to the geometric center of the group." alt="" coords="415,893,652,917"/>
<area shape="rect" id="node42" href="fullrmc.Generators.html#fullrmc.Generators.Translations.TranslationTowardsSymmetryAxisGenerator" target="_top" title="Generates random translation moves upon groups of atoms towards one of its symmetry" alt="" coords="715,845,996,869"/>
</map>
<div class="section" id="welcoming-videos">
<h2>Welcoming videos<a class="headerlink" href="#welcoming-videos" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first"><iframe width="580" height="315"
src="https://www.youtube.com/embed/untepXVc3BQ"
frameborder="0" allowfullscreen>
</iframe></div><p class="last">Molecular system full RMC simulation. Groups are set to molecules and smart moves are
applied. Translations along symmetry axes, rotations about symmetry axes, etc.</p>
</td>
</tr>
<tr class="row-even"><td><div class="first"><iframe width="580" height="315"
src="https://www.youtube.com/embed/yTnCAw1DK3Q?rel=0"
frameborder="0" allowfullscreen>
</iframe></div><p class="last">Atomic binary Nickel-Titanium shape memory alloy system phase transformation RMC
simulation. Random atomic translations are enough to reproduce short range ordering.
But swapping atoms is necessary to fit long range atomic correlations.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first"><iframe width="580" height="315"
src="https://www.youtube.com/embed/xnG0wnEfbJ8"
frameborder="0" allowfullscreen>
</iframe></div><p class="last">Molecular system mere atomic RMC simulation. Covalent bond electron density
polarization is modelled by allowing fullrmc to explore across energy low correlation
barriers.</p>
</td>
</tr>
<tr class="row-even"><td><div class="first"><iframe width="580" height="315"
src="https://www.youtube.com/embed/24Rd2EZ2vVo?rel=0"
frameborder="0" allowfullscreen>
</iframe></div><p class="last">Reverse Monte Carlo traditional fitting mode compared with fullrmc&#8217;s recursive
selection with exploring. This video shows how from a potential point of view exploring
allow to cross forbidden unlikely barriers and going out of local minimas.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="brief-description">
<h2>Brief Description<a class="headerlink" href="#brief-description" title="Permalink to this headline">¶</a></h2>
<p>Reverse Monte Carlo (RMC) is probably best known for its applications in condensed matter 
physics and solid state chemistry. fullrmc which stands for FUndamental Library Language 
for Reverse Monte Carlo is a modelling package to solve an inverse problem whereby an 
atomic/molecular model is adjusted until its atoms position have the greatest consistency 
with a set of experimental data.</p>
<p>fullrmc is a python package with its core and calculation modules optimized and compiled 
in Cython. fullrmc is not a standard RMC package but it&#8217;s rather unique in its approach 
to stochastically solving an atomic or molecular structure. fullrmc&#8217;s Engine sub-module 
is the main module that contains the definition of &#8216;Engine&#8217; which is the main and only 
class used to launch an RMC calculation. Engine reads only Protein Data Bank formatted 
atomic configuration <a class="reference external" href="http://deposit.rcsb.org/adit/docs/pdb_atom_format.html">&#8216;.pdb&#8217;</a> 
files and handles other definitions and attributes such as:</p>
<blockquote>
<div><ol class="arabic simple">
<li><strong>Group</strong>: Engine doesn&#8217;t understand atoms or molecules but group of atom indexes 
instead. A group is a set of atom indexes, allowing no indexes redundancy 
within the same group definition. A Group instance can contain any set of indexes 
and as many atom indexes as needed. Grouping atoms is essential to make clusters 
of atoms (residues, molecules, etc) evolve and move together. A group of 
a single atom index can be used to make a single atom move separately from the 
others. Engine&#8217;s &#8216;groups&#8217; attribute is a simple list of group instances containing 
all the desired and defined groups that one wants to move.</li>
<li><strong>Group selector</strong>: Engine requires a GroupSelector instance which is the artist 
that selects a group from the engine&#8217;s groups list at every engine runtime step. 
Among other properties, depending on which group selector is used by the engine, 
a GroupSelector can allow weighting which means selecting groups more or less 
frequently than the others, it can also allow selection recurrence and refinement 
of a single group, ordered and random selection is also possible.</li>
<li><strong>Move generator</strong>: Every group instance has its own MoveGenerator. Therefore 
every group of atoms when selected by the engine&#8217;s group selector at the engine&#8217;s 
runtime can perform a customizable and different kind of moves.</li>
<li><strong>Constraint</strong>: A constraint is a rule that controls certain aspect of the 
configuration upon moving groups. Engine&#8217;s &#8216;constraints&#8217; attribute is a list of 
all defined and used constraint instances, it is the judge that controls the 
evolution of the system by accepting or rejecting the move of a group. If engine&#8217;s 
constraints list is empty and contains no constraint definition, this will result 
in accepting all the generated moves.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="tetrahydrofuran-simple-example-yet-complete-and-straight-to-the-point">
<h2>Tetrahydrofuran simple example yet complete and straight to the point<a class="headerlink" href="#tetrahydrofuran-simple-example-yet-complete-and-straight-to-the-point" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">## Tetrahydrofuran (THF) molecule sketch</span>
<span class="c1">## </span>
<span class="c1">##              O</span>
<span class="c1">##   H41      /   \      H11</span>
<span class="c1">##      \  /         \  /</span>
<span class="c1">## H42-- C4    THF    C1 --H12</span>
<span class="c1">##        \  MOLECULE /</span>
<span class="c1">##         \         /</span>
<span class="c1">##   H31-- C3-------C2 --H21</span>
<span class="c1">##        /         \</span>
<span class="c1">##     H32            H22 </span>
<span class="c1">##</span>

<span class="c1">#   #####################################################################################   #</span>
<span class="c1">#   ############################### IMPORT WHAT IS NEEDED ###############################   #</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.PairDistributionConstraints</span> <span class="kn">import</span> <span class="n">PairDistributionConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.DistanceConstraints</span> <span class="kn">import</span> <span class="n">InterMolecularDistanceConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.BondConstraints</span> <span class="kn">import</span> <span class="n">BondConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.AngleConstraints</span> <span class="kn">import</span> <span class="n">BondsAngleConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.ImproperAngleConstraints</span> <span class="kn">import</span> <span class="n">ImproperAngleConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Core.MoveGenerator</span> <span class="kn">import</span> <span class="n">MoveGeneratorCollector</span>
<span class="kn">from</span> <span class="nn">fullrmc.Generators.Translations</span> <span class="kn">import</span> <span class="n">TranslationGenerator</span><span class="p">,</span> <span class="n">TranslationAlongSymmetryAxisGenerator</span>
<span class="kn">from</span> <span class="nn">fullrmc.Generators.Rotations</span> <span class="kn">import</span> <span class="n">RotationGenerator</span><span class="p">,</span> <span class="n">RotationAboutSymmetryAxisGenerator</span>

<span class="c1">#   #####################################################################################   #</span>
<span class="c1">#   ############################# DECLARE USEFUL VARIABLES ##############################   #</span>
<span class="n">pdfData</span>      <span class="o">=</span> <span class="s2">&quot;thf_pdf.exp&quot;</span>
<span class="n">pdbStructure</span> <span class="o">=</span> <span class="s2">&quot;thf.pdb&quot;</span>
<span class="n">enginePath</span>   <span class="o">=</span> <span class="s2">&quot;thf_engine.rmc&quot;</span>

<span class="c1">#   #####################################################################################   #</span>
<span class="c1">#   ################################# CREATE RMC SYSTEM #################################   #</span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="c1"># if engine is not created and saved</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">ENGINE</span><span class="o">.</span><span class="n">is_engine</span><span class="p">(</span><span class="n">enginePath</span><span class="p">)</span>
    <span class="c1"># create and initialize engine</span>
    <span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">enginePath</span><span class="p">,</span> <span class="n">freshStart</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="n">pdbFileName</span><span class="p">)</span>
    
    <span class="c1"># re-set structure boundary conditions</span>
    <span class="n">ENGINE</span><span class="o">.</span><span class="n">set_boundary_conditions</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">48.860</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mf">48.860</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">48.860</span><span class="p">]))</span>
    
    <span class="c1"># create and add pair distribution constraint to the engine</span>
    <span class="n">PDF_CONSTRAINT</span> <span class="o">=</span> <span class="n">PairDistributionConstraint</span><span class="p">(</span><span class="n">experimentalData</span><span class="o">=</span><span class="n">pdfData</span><span class="p">,</span> <span class="n">weighting</span><span class="o">=</span><span class="s2">&quot;atomicNumber&quot;</span><span class="p">)</span>
    <span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">PDF_CONSTRAINT</span><span class="p">])</span>
    
    <span class="c1"># create and add intermolecular distances constraint to the engine</span>
    <span class="n">EMD_CONSTRAINT</span> <span class="o">=</span> <span class="n">InterMolecularDistanceConstraint</span><span class="p">()</span>
    <span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">EMD_CONSTRAINT</span><span class="p">])</span>
    
    <span class="c1"># create and add bonds constraint to the engine</span>
    <span class="n">B_CONSTRAINT</span> <span class="o">=</span> <span class="n">BondConstraint</span><span class="p">()</span>
    <span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">B_CONSTRAINT</span><span class="p">])</span>
    <span class="n">B_CONSTRAINT</span><span class="o">.</span><span class="n">create_bonds_by_definition</span><span class="p">(</span> <span class="n">bondsDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;THF&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;O&#39;</span> <span class="p">,</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span> <span class="mf">1.20</span><span class="p">,</span> <span class="mf">1.70</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s1">&#39;O&#39;</span> <span class="p">,</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span> <span class="mf">1.20</span><span class="p">,</span> <span class="mf">1.70</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;H11&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;H12&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;H21&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;H22&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;H31&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;H32&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;H41&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;H42&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">)]</span> <span class="p">})</span>
    
    <span class="c1"># create and add angles constraint to the engine</span>
    <span class="n">BA_CONSTRAINT</span> <span class="o">=</span> <span class="n">BondsAngleConstraint</span><span class="p">()</span>
    <span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">BA_CONSTRAINT</span><span class="p">])</span>
    <span class="n">BA_CONSTRAINT</span><span class="o">.</span><span class="n">create_angles_by_definition</span><span class="p">(</span> <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;THF&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s1">&#39;O&#39;</span>  <span class="p">,</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">125</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span><span class="s1">&#39;O&#39;</span>  <span class="p">,</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span><span class="s1">&#39;O&#39;</span>  <span class="p">,</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">95</span> <span class="p">,</span> <span class="mi">115</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">95</span> <span class="p">,</span> <span class="mi">115</span><span class="p">),</span>
                                                                          <span class="c1"># H-C-H angle</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span><span class="s1">&#39;H11&#39;</span><span class="p">,</span><span class="s1">&#39;H12&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span><span class="s1">&#39;H21&#39;</span><span class="p">,</span><span class="s1">&#39;H22&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span><span class="s1">&#39;H31&#39;</span><span class="p">,</span><span class="s1">&#39;H32&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span><span class="s1">&#39;H41&#39;</span><span class="p">,</span><span class="s1">&#39;H42&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                          <span class="c1"># H-C-O angle</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span><span class="s1">&#39;H11&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span><span class="s1">&#39;H12&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span><span class="s1">&#39;H41&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span><span class="s1">&#39;H42&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>                                                                           
                                                                          <span class="c1"># H-C-C</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span><span class="s1">&#39;H11&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span><span class="s1">&#39;H12&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span><span class="s1">&#39;H21&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span><span class="s1">&#39;H21&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span><span class="s1">&#39;H22&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span><span class="s1">&#39;H22&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span><span class="s1">&#39;H31&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span><span class="s1">&#39;H31&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span><span class="s1">&#39;H32&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span><span class="s1">&#39;H32&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span><span class="s1">&#39;H41&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C4&#39;</span> <span class="p">,</span><span class="s1">&#39;H42&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span> <span class="p">]</span> <span class="p">})</span>
    
    <span class="c1"># create and add improper angles constraint to the engine keeping THF molecules&#39; atoms in the plane</span>
    <span class="n">IA_CONSTRAINT</span> <span class="o">=</span> <span class="n">ImproperAngleConstraint</span><span class="p">()</span>
    <span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">IA_CONSTRAINT</span><span class="p">])</span>
    <span class="n">IA_CONSTRAINT</span><span class="o">.</span><span class="n">create_angles_by_definition</span><span class="p">(</span> <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;THF&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
                                                                          <span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="p">]</span> <span class="p">})</span>
    
    <span class="c1"># initialize constraints data</span>
    <span class="n">ENGINE</span><span class="o">.</span><span class="n">initialize_used_constraints</span><span class="p">()</span>
    
    <span class="c1"># save engine</span>
    <span class="n">ENGINE</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="c1"># if engine is created and saved, it can be simply loaded.</span>
<span class="k">else</span><span class="p">:</span> 
    <span class="n">ENGINE</span> <span class="o">=</span> <span class="n">ENGINE</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">engineFilePath</span><span class="p">)</span>
    <span class="c1"># unpack constraints before fitting in case tweaking is needed</span>
    <span class="n">PDF_CONSTRAINT</span><span class="p">,</span> <span class="n">EMD_CONSTRAINT</span><span class="p">,</span> <span class="n">B_CONSTRAINT</span><span class="p">,</span> <span class="n">BA_CONSTRAINT</span><span class="p">,</span> <span class="n">IA_CONSTRAINT</span> <span class="o">=</span> <span class="n">ENGINE</span><span class="o">.</span><span class="n">constraints</span>

<span class="c1">#   #####################################################################################   #</span>
<span class="c1">#   ################################# RUN RMC ON ATOMS ##################################   #</span>
<span class="c1"># set groups as atoms. By default when the engine is constructed, all groups are single atoms.</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_groups_as_atoms</span><span class="p">()</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numberOfSteps</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">saveFrequency</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1">#   #####################################################################################   #</span>
<span class="c1">#   ############################### RUN RMC ON MOLECULES ################################   #</span>
<span class="c1">## set groups as molecules instead of atoms</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_groups_as_molecules</span><span class="p">()</span>  
<span class="c1"># set moves generators to all groups as a collection of random translation and rotation</span>
<span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">ENGINE</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
    <span class="n">mg</span> <span class="o">=</span> <span class="n">MoveGeneratorCollector</span><span class="p">(</span><span class="n">collection</span><span class="o">=</span><span class="p">[</span><span class="n">TranslationGenerator</span><span class="p">(),</span><span class="n">RotationGenerator</span><span class="p">()],</span> <span class="n">randomize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">set_move_generator</span><span class="p">(</span> <span class="n">mg</span> <span class="p">)</span>
<span class="c1">## Uncomment to use any of the following moves generators instead of the earlier collector</span>
<span class="c1">## Also other moves generators can be used to achieve a better fit for instance:</span>
<span class="c1">#[g.set_move_generator(TranslationAlongSymmetryAxisGenerator(axis=0)) for g in ENGINE.groups]</span>
<span class="c1">#[g.set_move_generator(TranslationAlongSymmetryAxisGenerator(axis=1)) for g in ENGINE.groups]</span>
<span class="c1">#[g.set_move_generator(TranslationAlongSymmetryAxisGenerator(axis=2)) for g in ENGINE.groups]</span>
<span class="c1">#[g.set_move_generator(RotationAboutSymmetryAxisGenerator(axis=0))    for g in ENGINE.groups]</span>
<span class="c1">#[g.set_move_generator(RotationAboutSymmetryAxisGenerator(axis=1))    for g in ENGINE.groups]</span>
<span class="c1">#[g.set_move_generator(RotationAboutSymmetryAxisGenerator(axis=2))    for g in ENGINE.groups]</span>
<span class="c1">## Molecular constraints are not necessary any more because groups are set to molecules.</span>
<span class="c1">## At every engine step a whole molecule is rotate or translated therefore its internal</span>
<span class="c1">## distances and properties are safe from any changes. At any time constraints can be </span>
<span class="c1">## turn on again using the same method with a True flag. e.g. B_CONSTRAINT.set_used(True)</span>
<span class="n">B_CONSTRAINT</span><span class="o">.</span><span class="n">set_used</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">BA_CONSTRAINT</span><span class="o">.</span><span class="n">set_used</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">IA_CONSTRAINT</span><span class="o">.</span><span class="n">set_used</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="c1">## run engine and perform RMC on molecules</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numberOfSteps</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">saveFrequency</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    
<span class="c1">#   #####################################################################################   #</span>
<span class="c1">#   ################################### PLOT TOTAL GR ###################################   #</span>
<span class="n">PDF_CONSTRAINT</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>The result shown in the figures herein is obtained by running fullrmc Engine for several hours on molecular groups.
Position optimization is achieved by using a RecursiveGroupSelector to refine every selected group position
and alternating groups moves generators. RotationAboutSymmetryAxisGenerator is used to fit the ring orientation, 
then TranslationAlongSymmetryAxisGenerator is used to translate molecules along meaningful directions. 
At the end, groups a reset to single atom index and RandomSelector is used to select groups randomly.
the Engine is run for additional several hours to refine atoms positions separately.</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left" id="id2">
<a class="reference internal image-reference" href="_images/thfBox.png"><img alt="_images/thfBox.png" src="_images/thfBox.png" style="width: 300px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">a) Structure containing 800
Tetrahydrofuran randomly generated.</span></p>
</div>
</td>
<td><div class="first last figure align-left" id="id3">
<a class="reference internal image-reference" href="_images/beforeFit.png"><img alt="_images/beforeFit.png" src="_images/beforeFit.png" style="width: 300px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">b) Initial pair distribution function
calculated before any fitting.</span></p>
</div>
</td>
<td><div class="first last figure align-left" id="id4">
<a class="reference internal image-reference" href="_images/afterFit.png"><img alt="_images/afterFit.png" src="_images/afterFit.png" style="width: 300px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">c) pair distribution function
calculated after about 20 hours of
Engine runtime.</span></p>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sub-packages">
<h2>Sub-packages<a class="headerlink" href="#sub-packages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Core.html">fullrmc.Core package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.Collection">Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.Constraint">Constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.Group">Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.GroupSelector">GroupSelector</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.MoveGenerator">MoveGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.boundary_conditions_collection">boundary conditions collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.reciprocal_space">reciprocal space</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.pairs_distances">pairs distances</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.atomic_coordination">atomic coordination number</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.atomic_distances">atomic distances</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.bonds">bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.angles">angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.dihedral_angles">dihedral angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.improper_angles">improper angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.pairs_histograms">pairs histogram</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Selectors.html">fullrmc.Selectors package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Selectors.html#module-fullrmc.Selectors.OrderedSelectors">OrderedSelectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Selectors.html#module-fullrmc.Selectors.RandomSelectors">RandomSelectors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Generators.html">fullrmc.Generators package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Rotations">Rotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Translations">Translations</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Agitations">Agitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Swaps">Swap</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Removes">Removes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Constraints.html">fullrmc.Constraints package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.Collection">Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.DistanceConstraints">DistanceConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.AtomicCoordinationConstraints">CoordinationConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.BondConstraints">BondConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.AngleConstraints">AngleConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.DihedralAngleConstraints">DihedralAngleConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.ImproperAngleConstraints">ImproperAngleConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.PairDistributionConstraints">PairDistributionConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.PairCorrelationConstraints">PairCorrelationConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.StructureFactorConstraints">StructureFactorConstraints</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="sub-modules">
<h2>Sub-modules<a class="headerlink" href="#sub-modules" title="Permalink to this headline">¶</a></h2>
<p>Engine is fullrmc main module. It contains &#8216;Engine&#8217; the main class 
of fullrmc which is the Reverse Monte Carlo artist. The engine class 
takes only Protein Data Bank formatted files 
<a class="reference external" href="http://deposit.rcsb.org/adit/docs/pdb_atom_format.html">&#8216;.pdb&#8217;</a> as 
atomic/molecular input structure. It handles and fits simultaneously many 
experimental data while controlling the evolution of the system using 
user-defined molecular or atomistic constraints such as bond-length, 
bond-angles, inter-molecular-distances, dihedral angles, etc.</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">fullrmc.Engine.</code><code class="descname">Engine</code><span class="sig-paren">(</span><em>path=None</em>, <em>frames=None</em>, <em>logFile=None</em>, <em>freshStart=False</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>fulrmc&#8217;s Reverse Monte Carlo (RMC) engine, used to launched a RMC simulation. 
It has the capability to use and fit simultaneously multiple sets of 
experimental data. One can also define constraints such as distances, 
bonds length, angles and many others.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>path (None, string): Engine repository path to save the engine. If None is 
given path will be set when saving the engine using Engine.save method. if a 
non-empty directory is found at the given path an error will be raised.</li>
<li>frames (None, list): List of frames name. Frames are used to store fitting
data. Multiple frames can be used to create a fitting story or to fit 
multiple structures simultaneously. Also multiple frames can be used to 
launch multiple simulations at the same time and merge structures at some 
predefined merging frequency.
If None is given, a single frame &#8216;0&#8217; is initialized automatically.</li>
<li>logFile (None, string): Logging file basename. A logging file full name will
be the given logFile appended &#8216;.log&#8217; extension automatically.
If None is given, logFile is left unchanged.</li>
<li>freshStart (boolean): Whether to remove any existing fullrmc engine at the 
given path if found. If set to False, an error will be raise if a fullrmc 
engine or a non-empty directory is found at the given path.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="n">pdbFileName</span><span class="p">)</span>

<span class="c1"># Add constraints ...</span>
<span class="c1"># Re-define groups if needed ...</span>
<span class="c1"># Re-define groups selector if needed ...</span>
<span class="c1"># Re-define moves generators if needed ...</span>

<span class="c1"># save engine</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="c1"># run engine for 10000 steps and save only at the end</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numberOfSteps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">saveFrequency</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">savePath</span><span class="o">=</span><span class="s2">&quot;system.rmc&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">info</code></dt>
<dd><p>Engine&#8217;s information (version, id) tuple.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">frames</code></dt>
<dd><p>Engine&#8217;s frames list copy.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">usedFrame</code></dt>
<dd><p>Engine&#8217;s frame in use.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">lastSelectedGroupIndex</code></dt>
<dd><p>The last moved group instance index in groups list.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">lastSelectedGroup</code></dt>
<dd><p>The last moved group instance.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">lastSelectedAtomsIndexes</code></dt>
<dd><p>The last moved atoms indexes.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">state</code></dt>
<dd><p>Engine&#8217;s state.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">generated</code></dt>
<dd><p>Number of generated moves.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">removed</code></dt>
<dd><p>removed atoms tuple (tried, accepted, ratio)</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">tried</code></dt>
<dd><p>Number of tried moves.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">accepted</code></dt>
<dd><p>Number of accepted moves.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">tolerated</code></dt>
<dd><p>Number of tolerated steps in spite of increasing total totalStandardError</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">tolerance</code></dt>
<dd><p>Tolerance in percent.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">groups</code></dt>
<dd><p>Engine&#8217;s defined groups list.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">pdb</code></dt>
<dd><p>Engine&#8217;s pdbParser instance.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">boundaryConditions</code></dt>
<dd><p>Engine&#8217;s boundaryConditions instance.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">isPBC</code></dt>
<dd><p>Whether boundaryConditions are periodic.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">isIBC</code></dt>
<dd><p>Whether boundaryConditions are infinte.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">basisVectors</code></dt>
<dd><p>The boundary conditions basis vectors in case of PeriodicBoundaries, None in 
case of InfiniteBoundaries.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">reciprocalBasisVectors</code></dt>
<dd><p>The boundary conditions reciprocal basis vectors in case of 
PeriodicBoundaries, None in case of InfiniteBoundaries.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">volume</code></dt>
<dd><p>The boundary conditions basis volume in case of PeriodicBoundaries, 
None in case of InfiniteBoundaries.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">realCoordinates</code></dt>
<dd><p>The real coordinates of the current configuration.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">boxCoordinates</code></dt>
<dd><p>The box coordinates of the current configuration in case of 
PeriodicBoundaries. Similar to realCoordinates in case of InfiniteBoundaries.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">numberOfMolecules</code></dt>
<dd><p>Number of molecules.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">moleculesIndexes</code></dt>
<dd><p>All atoms molecules indexes.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">moleculesNames</code></dt>
<dd><p>Al atoms molecules names.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">elementsIndexes</code></dt>
<dd><p>All atoms element index in elements list.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">elements</code></dt>
<dd><p>Sorted set of all existing atom elements.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">allElements</code></dt>
<dd><p>All atoms elements.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">namesIndexes</code></dt>
<dd><p>All atoms name index in names list</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">names</code></dt>
<dd><p>Srted set of all existing atom names.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">allNames</code></dt>
<dd><p>All atoms name list.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">numberOfNames</code></dt>
<dd><p>Number of defined atom names set.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">numberOfAtoms</code></dt>
<dd><p>Number of atoms in pdb structure.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">numberOfAtomsPerName</code></dt>
<dd><p>Number of atoms per name dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">numberOfElements</code></dt>
<dd><p>Number of different elements in the configuration.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">numberOfAtomsPerElement</code></dt>
<dd><p>Number of atoms per element dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">numberDensity</code></dt>
<dd><p>System&#8217;s number density computed as <span class="math">\(\rho_{0}=\frac{N}{V}\)</span>
where N is the total number of atoms and V the volume of the system.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">constraints</code></dt>
<dd><p>List copy of all constraints instances.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">groupSelector</code></dt>
<dd><p>Engine&#8217;s group selector instance.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">totalStandardError</code></dt>
<dd><p>Engine&#8217;s last recorded totalStandardError of the current configuration.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_original_data</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span></dt>
<dd><p>Get original data as initialized and parsed from pdb.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>name (string): Data name.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (object): Data value</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">is_engine</code><span class="sig-paren">(</span><em>path</em>, <em>repo=False</em>, <em>mes=False</em><span class="sig-paren">)</span></dt>
<dd><p>Get whether a fullrmc engine is stored in the given path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>path (string): The path to fetch.</li>
<li>repo (boolean): Whether to return repository if an engine is found. 
Otherwise None is returned.</li>
<li>mes (boolean): Whether to return explanatory message.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): The fetch result, True if engine is found False 
otherwise.</li>
<li>repo (pyrep.Repository): The repository instance. 
This is returned only if &#8216;repo&#8217; argument is set to True.</li>
<li>message (string): The explanatory message.
This is returned only if &#8216;mes&#8217; argument is set to True.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">save</code><span class="sig-paren">(</span><em>path=None</em>, <em>copyFrames=True</em><span class="sig-paren">)</span></dt>
<dd><p>Save engine to disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>path (None, string): Repository path to save the engine. 
If path is None, engine&#8217;s path is used to update already saved engine. 
If path and engine&#8217;s path are both None, and error will be raised.</li>
<li>copyFrames (boolean): If path is None, this argument is discarded. 
This argument sets whether to copy all frames data to the new repository 
path. If path is not None and this argument is False, Only used frame data 
will be copied and other frames will be discarded in new engine.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<p>N.B. If path is given, it will automatically updates engine&#8217;s path to point 
towards given path.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">load</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span></dt>
<dd><p>Load and return engine instance. None of the current engine attribute will be 
updated. must be used as the following</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>path (string): the file path to save the engine</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>engine (Engine): the engine&#8217;s instance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_log_file</code><span class="sig-paren">(</span><em>logFile</em><span class="sig-paren">)</span></dt>
<dd><p>Set the log file basename.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>logFile (None, string): Logging file basename. A logging file full name will
be the given logFile appended &#8216;.log&#8217; extension automatically.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">add_frames</code><span class="sig-paren">(</span><em>frames</em><span class="sig-paren">)</span></dt>
<dd><p>Add a single or multiple frames to engine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>frames (string, list): Frames name. It can be a string to add a single
frame or a list of strings to add multiple frames.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">reinit_frame</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span></dt>
<dd><p>Reset frame data to initial pdb coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>frame (string): The frame name to set.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_used_frame</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span></dt>
<dd><p>Set engine frame in use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>frame (string): The frame name to set.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">delete_frame</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span></dt>
<dd><p>Delete frame data from Engine as well as from system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>frame (string): The frame name to delete.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">rename_frame</code><span class="sig-paren">(</span><em>frame</em>, <em>newName</em><span class="sig-paren">)</span></dt>
<dd><p>Rename frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>frame (string): The frame name to rename.</li>
<li>newName (string): The frame new name.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">export_pdb</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span></dt>
<dd><p>Export a pdb file of the last refined and save configuration state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>path (string): the pdb file path.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_pdb</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>get a pdb instance of the last refined and save configuration state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>pdb (pdbParser): the pdb instance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_tolerance</code><span class="sig-paren">(</span><em>tolerance</em><span class="sig-paren">)</span></dt>
<dd><p>Sets the runtime engine tolerance value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>tolerance (number): The runtime tolerance parameters. 
It&#8217;s the percentage of allowed unsatisfactory &#8216;tried&#8217; moves.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_group_selector</code><span class="sig-paren">(</span><em>selector</em><span class="sig-paren">)</span></dt>
<dd><p>Sets the engine group selector instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>groups (None, GroupSelector): the GroupSelector instance. 
If None, RandomSelector is set automatically.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">clear_groups</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Clear all engine&#8217;s defined groups.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">add_group</code><span class="sig-paren">(</span><em>g</em>, <em>broadcast=True</em><span class="sig-paren">)</span></dt>
<dd><p>Add a group to engine&#8217;s groups list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>g (Group, integer, list, set, tuple numpy.ndarray): Group instance, integer, 
list, tuple, set or numpy.ndarray of atoms indexes of atoms indexes.</li>
<li>broadcast (boolean): Whether to broadcast &#8220;update groups&#8221;. Keep True 
unless you know what you are doing.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_groups</code><span class="sig-paren">(</span><em>groups</em><span class="sig-paren">)</span></dt>
<dd><p>Sets the engine groups of indexes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>groups (None, Group, list): A single Group instance or a list, tuple, 
set of any of Group instance, integer, list, set, tuple or numpy.ndarray 
of atom indexes that will be set one by one by set_group method.
If None, single atom groups of all atoms will be all automatically created 
which is the same as using set_groups_as_atoms method.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">add_groups</code><span class="sig-paren">(</span><em>groups</em><span class="sig-paren">)</span></dt>
<dd><p>Add groups to engine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>groups (Group, list): Group instance or list of groups, where every 
group must be a Group instance or a numpy.ndarray of atoms indexes of 
type numpy.int32.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_groups_as_atoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Automatically set engine&#8217;s groups as single atom groups of all atoms.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_groups_as_molecules</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Automatically set engine&#8217;s groups indexes according to molecules indexes.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_pdb</code><span class="sig-paren">(</span><em>pdb</em>, <em>boundaryConditions=None</em>, <em>names=None</em>, <em>elements=None</em>, <em>moleculesIndexes=None</em>, <em>moleculesNames=None</em><span class="sig-paren">)</span></dt>
<dd><p>Set used frame pdb configuration. Engine and constraints data will be 
automatically reset but not constraints definitions. If pdb was already set and 
this is a resetting of a different atomic configuration, with different elements 
or atomic order, or different size and number of atoms, constraints definitions 
must be reset manually. In general, their is no point in changing the atomic 
configuration of a completely different atomic nature. It is advisable to create 
a new engine from scratch or redefining all constraints definitions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>pdb (pdbParser, string): the configuration pdb as a pdbParser instance or 
a path string to a pdb file.</li>
<li>boundaryConditions (None, InfiniteBoundaries, PeriodicBoundaries, 
numpy.ndarray, number): The configuration&#8217;s boundary conditions.
If None, boundaryConditions are set to InfiniteBoundaries with no periodic 
boundaries. If numpy.ndarray is given, it must be pass-able to a 
PeriodicBoundaries. Normally any real numpy.ndarray of shape (1,), (3,1), 
(9,1), (3,3) is allowed. If number is given, it&#8217;s like a numpy.ndarray of 
shape (1,), it is assumed as a cubic box of box length equal to number.</li>
<li>names (None, list): All pdb atoms names list.
If None names will be calculated automatically by parsing pdb instance.</li>
<li>elements (None, list): All pdb atoms elements list.
If None elements will be calculated automatically by parsing pdb instance.</li>
<li>moleculesIndexes (None, list, numpy.ndarray): The molecules indexes list.
If None moleculesIndexes will be calculated automatically by parsing pdb 
instance.</li>
<li>moleculesNames (None, list): The molecules names list. Must have the 
length of the number of atoms. If None, it is automatically generated as 
the pdb residues name.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_boundary_conditions</code><span class="sig-paren">(</span><em>boundaryConditions</em><span class="sig-paren">)</span></dt>
<dd><p>Sets the configuration boundary conditions. Any type of periodic boundary 
conditions are allowed and not restricted to cubic. Engine and constraintsData 
will be automatically reset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>boundaryConditions (None, InfiniteBoundaries, PeriodicBoundaries, 
numpy.ndarray, number): The configuration&#8217;s boundary conditions.
If None, boundaryConditions are set to InfiniteBoundaries with no periodic 
boundaries. If numpy.ndarray is given, it must be pass-able to a
PeriodicBoundaries. Normally any real numpy.ndarray of shape (1,), (3,1), 
(9,1), (3,3) is allowed. If number is given, it&#8217;s like a numpy.ndarray of 
shape (1,), it is assumed as a cubic box of box length equal to number.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_number_density</code><span class="sig-paren">(</span><em>numberDensity</em><span class="sig-paren">)</span></dt>
<dd><p>Sets system&#8217;s number density. This is used to correct system&#8217;s
volume. It can be used only with InfiniteBoundaries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>numberDensity (number): The number density value.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_molecules_indexes</code><span class="sig-paren">(</span><em>moleculesIndexes=None</em>, <em>moleculesNames=None</em><span class="sig-paren">)</span></dt>
<dd><p>Sets moleculesIndexes list, assigning each atom to a molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>moleculesIndexes (None, list, numpy.ndarray): The molecules indexes list.
If None moleculesIndexes will be calculated automatically by parsing pdb 
instance.</li>
<li>moleculesNames (None, list): The molecules names list. Must have the 
length of the number of atoms. If None, it is automatically generated as 
the pdb residues name.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_elements_indexes</code><span class="sig-paren">(</span><em>elements=None</em><span class="sig-paren">)</span></dt>
<dd><p>Sets elements list, assigning a type element to each atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>elements (None, list): All pdb atoms elements list.
If None elements will be calculated automatically by parsing pdb instance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_names_indexes</code><span class="sig-paren">(</span><em>names=None</em><span class="sig-paren">)</span></dt>
<dd><p>Sets names list, assigning a name to each atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>names (None, list): The names indexes list.
If None names will be generated automatically by parsing pdbParser instance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">visualize</code><span class="sig-paren">(</span><em>commands=None</em>, <em>foldIntoBox=False</em>, <em>boxToCenter=False</em>, <em>boxWidth=2</em>, <em>boxStyle='solid'</em>, <em>boxColor='yellow'</em>, <em>bgColor='black'</em>, <em>displayParams=None</em>, <em>representationParams='Lines'</em>, <em>otherParams=None</em><span class="sig-paren">)</span></dt>
<dd><p>Visualize the last configuration using pdbParser visualize_vmd method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">commands (None, list, tuple): List of commands to pass upon calling vmd.
commands can be a .dcd file to load a trajectory for instance.</p>
</li>
<li><p class="first">foldIntoBox (boolean): Whether to fold all atoms into simulation box 
before visualization.</p>
</li>
<li><p class="first">boxToCenter (boolean): Translate box center to atom coordinates center.</p>
</li>
<li><p class="first">boxWidth (number): Visualize the simulation box by giving the lines width.
If 0 then the simulation box is not visualized.</p>
</li>
<li><p class="first">boxStyle (str): The box line style, it can be either solid or dashed.</p>
</li>
<li><p class="first">boxColor (str): Choose the simulation box color among the following:</p>
<p>blue, red, gray, orange, yellow, tan, silver, green,
white, pink, cyan, purple, lime, mauve, ochre, iceblue, 
black, yellow2, yellow3, green2, green3, cyan2, cyan3, blue2,
blue3, violet, violet2, magenta, magenta2, red2, red3, 
orange2, orange3.</p>
</li>
<li><p class="first">bgColor (str): Set the background color.</p>
</li>
<li><p class="first">displayParams(None, dict): Set the display parameters. If None, default 
parameters will be applied. If dictionary the following keys can be used.</p>
<ul class="simple">
<li>&#8216;depth cueing&#8217; (default True): Set the depth cueing flag.</li>
<li>&#8216;cue density&#8217; (default 0.1): Set the depth density.</li>
<li>&#8216;cue mode&#8217; (default &#8216;Exp&#8217;): Set the depth mode among &#8216;linear&#8217;, 
&#8216;Exp&#8217; and &#8216;Exp2&#8217;.</li>
</ul>
</li>
<li><p class="first">representationParams(str): Set representation method among the following:</p>
<p>Lines, Bonds, DynamicBonds, HBonds, Points, VDW, CPK, Licorice, Beads, 
Dotted, Solvent. And add parameters accordingly if needed. e.g.</p>
<ul class="simple">
<li>Points representation accept only size parameter e.g. &#8216;Points 5&#8217;</li>
<li>CPK representation can accept respectively 4 parameters as the 
following &#8216;Sphere Scale&#8217;, &#8216;Bond Radius&#8217;, &#8216;Sphere Resolution&#8217;, 
&#8216;Bond Resolution&#8217; e.g. &#8216;CPK 1.0 0.2 50 50&#8217;</li>
<li>VDW representation can accept respectively 2 parameters as the following 
&#8216;Sphere Scale&#8217;, &#8216;Sphere Resolution&#8217; e.g. &#8216;VDW 0.7 100&#8217;</li>
</ul>
</li>
<li><p class="first">otherParams(None, list, set, tuple): Any other parameters in a form of a 
list of strings.</p>
<p>e.g. [&#8216;display resize 700 700&#8217;, &#8216;rotate x to 45&#8217;, &#8216;scale to 0.02&#8217;, 
&#8216;axes location off&#8217;]</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">add_constraints</code><span class="sig-paren">(</span><em>constraints</em><span class="sig-paren">)</span></dt>
<dd><p>Add constraints to the engine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>constraints (Constraint, list, set, tuple): A constraint instance or 
list of constraints instances</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">remove_constraints</code><span class="sig-paren">(</span><em>constraints</em><span class="sig-paren">)</span></dt>
<dd><p>Remove constraints from engine list of constraints.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>constraints (Constraint, list, set, tuple): A constraint instance or 
list of constraints instances</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">reset_constraints</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Reset constraints flags.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">reset_engine</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Re-initialize engine and resets constraints flags and data.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_total_standard_error</code><span class="sig-paren">(</span><em>constraints</em>, <em>current='standardError'</em><span class="sig-paren">)</span></dt>
<dd><p>Computes the total standard error as the sum of all constraints&#8217; standard error.</p>
<div class="math">
\[\chi^{2} = \sum \limits_{i}^{N} (\frac{stdErr_{i}}{variance_{i}})^{2}\]</div>
<p>Where:</p>
<p><span class="math">\(variance_{i}\)</span> is the variance value of the constraint i.</p>
<p><span class="math">\(stdErr_{i}\)</span> the standard error of the constraint i defined as <span class="math">\(\sum \limits_{j}^{points} (target_{i,j}-computed_{i,j})^{2} = (Y_{i,j}-F(X_{i,j}))^{2}\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>constraints (list): All constraints used to calculate total 
totalStandardError.</li>
<li>current (str): which standard error to use. can be anything like
standardError, afterMoveStandardError or amputatedStandardError, etc.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>totalStandardError (list): The computed total total standard error.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_total_standard_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Computes and sets the total totalStandardError of active constraints.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_used_constraints</code><span class="sig-paren">(</span><em>sortConstraints=False</em><span class="sig-paren">)</span></dt>
<dd><p>Parses all engine constraints and returns different lists of the active ones.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>sortConstraints (boolean): Whether to sort used constraints according 
to their computation cost property. This is can minimize computations
and enhance performance by computing less costly constraints first.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>usedConstraints (list): All types of active constraints that will be used 
in engine runtime.</li>
<li>constraints (list): All active constraints instances among usedConstraints 
list that will contribute to the engine total totalStandardError</li>
<li>RigidConstraint (list): All active RigidConstraint constraints instances 
among usedConstraints list that won&#8217;t contribute to the engine total 
totalStandardError</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">initialize_used_constraints</code><span class="sig-paren">(</span><em>force=False</em>, <em>sortConstraints=False</em><span class="sig-paren">)</span></dt>
<dd><p>Calls get_used_constraints method, re-initializes constraints when needed and 
return them all.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>force (boolean): Whether to force initializing constraints regardless 
of their state.</li>
<li>sortConstraints (boolean): Whether to sort used constraints according 
to their computation cost property. This is can minimize computations
and enhance performance by computing less costly constraints first.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>usedConstraints (list): All types of active constraints that will be used 
in engine runtime.</li>
<li>constraints (list): All active constraints instances among usedConstraints 
list that will contribute to the engine total totalStandardError</li>
<li>RigidConstraint (list): All active RigidConstraint constraints instances 
among usedConstraints list that won&#8217;t contribute to the engine total 
totalStandardError.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">run</code><span class="sig-paren">(</span><em>numberOfSteps=100000</em>, <em>sortConstraints=True</em>, <em>saveFrequency=1000</em>, <em>frame=None</em>, <em>xyzFrequency=None</em>, <em>xyzPath='trajectory.xyz'</em>, <em>restartPdb='restart.pdb'</em>, <em>ncores=None</em><span class="sig-paren">)</span></dt>
<dd><p>Run the Reverse Monte Carlo engine by performing random moves on engine groups.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>numberOfSteps (integer): The number of steps to run.</li>
<li>sortConstraints (boolean): Whether to sort used constraints according 
to their computation cost property. This is can minimize computations
and enhance performance by computing less costly constraints first.</li>
<li>saveFrequency (integer): Save engine every saveFrequency steps.
Save will be omitted if totalStandardError has not decreased.</li>
<li>xyzFrequency (None, integer): Save coordinates to .xyz file every 
xyzFrequency steps regardless totalStandardError has decreased or not.
If None, no .xyz file will be generated.</li>
<li>xyzPath (string): Save coordinates to .xyz file.</li>
<li>restartPdb (None, string): Export a pdb file of the last configuration at 
the end of the run. If None is given, no pdb file will be exported. If 
string is given, it should be the path and the pdb file name.</li>
<li>ncores (None, integer): set the number of cores to use. If None, is  
given, ncores will be set automatically to 1. This argument is only
effective if fullrmc is compiled with openmp.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">fullrmc.Engine.</code><code class="descname">generate_random_float</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>random() -&gt; x in the interval [0, 1).</p>
</dd></dl>

<p>This module provides all the global types, variables and some general methods that fullrmc needs.</p>
<div class="section" id="types">
<h3>Types:<a class="headerlink" href="#types" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>INT_TYPE: The integer data type adopted by fullrmc.</li>
<li>FLOAT_TYPE: The floating data type adopted by fullrmc.</li>
</ol>
</div>
<div class="section" id="variables">
<h3>Variables:<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>PRECISION: The floating data type precision variable.</li>
<li>FLOAT_PLUS_INFINITY: The floating data type maximum possible number.</li>
<li>FLOAT_MINUS_INFINITY: The floating data type minimum possible number.</li>
<li>INT_PLUS_INFINITY: The integer data type maximum possible number.</li>
<li>INT_MINUS_INFINITY: The integer data type minimum possible number.</li>
<li>PI: pi the ratio of a circle&#8217;s circumference to its diameter.</li>
</ol>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">fullrmc.Globals.</code><code class="descname">Logger</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">pysimplelog.SimpleLog.Logger</span></code></p>
<p>fullrmc&#8217;s logger.</p>
<dl class="method">
<dt>
<code class="descname">fixed</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span></dt>
<dd><p>alias to message at fixed level</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">accepted</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span></dt>
<dd><p>alias to message at move accepted level</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">rejected</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span></dt>
<dd><p>alias to message at move rejected level</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">nottried</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span></dt>
<dd><p>alias to message at move not tried level</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">saved</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span></dt>
<dd><p>alias to message at save engine level</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">impl</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span></dt>
<dd><p>alias to message at implement engine level</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">usage</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span></dt>
<dd><p>alias to message at usage engine level</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


        </div>
            </div>
        </div>
        
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">fullrmc package</a><ul>
<li><a class="reference internal" href="#welcoming-videos">Welcoming videos</a></li>
<li><a class="reference internal" href="#brief-description">Brief Description</a></li>
<li><a class="reference internal" href="#tetrahydrofuran-simple-example-yet-complete-and-straight-to-the-point">Tetrahydrofuran simple example yet complete and straight to the point</a></li>
<li><a class="reference internal" href="#sub-packages">Sub-packages</a></li>
<li><a class="reference internal" href="#sub-modules">Sub-modules</a><ul>
<li><a class="reference internal" href="#types">Types:</a></li>
<li><a class="reference internal" href="#variables">Variables:</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="fullrmc.Core.html"
                        title="next chapter">fullrmc.Core package</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        
        <div class="clearer"></div>
        </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a>
        </li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a>
             |
        
        </li>
        <li class="right" >
          <a href="fullrmc.Core.html" title="fullrmc.Core package"
             >next</a>
             |
        
        </li>
        <li><a href="#">fullrmc 3.0.0, the Reverse Monte Carlo (RMC) package</a> &raquo;</li> 
      </ul>
    </div>
            <div class="footer">
                    &copy; Copyright 2015, Bachir Aoun.
            </div>
    </body>
</html>